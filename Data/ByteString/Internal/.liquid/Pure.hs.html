<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>./Data/ByteString/Internal/Pure.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><a class=annot href="#"><span class=annottext>GHC.Types.Module</span><span class='hs-comment'>{-# LANGUAGE MagicHash #-}</span></a>
<span class=hs-linenum>  2: </span><span class='hs-comment'>{-# LANGUAGE BangPatterns #-}</span>
<span class=hs-linenum>  3: </span><span class='hs-comment'>{-# LANGUAGE MultiWayIf #-}</span>
<span class=hs-linenum>  4: </span>
<span class=hs-linenum>  5: </span><span class='hs-comment'>-- {-@ liquid "--compile-spec" @-}</span>
<span class=hs-linenum>  6: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>liquid</span> <span class='hs-str'>"--no-termination"</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>  7: </span>
<span class=hs-linenum>  8: </span><span class='hs-comment'>-- Enable yields to make `isValidUtf8` safe to use on large inputs.</span>
<span class=hs-linenum>  9: </span><span class='hs-comment'>{-# OPTIONS_GHC -fno-omit-yields #-}</span>
<span class=hs-linenum> 10: </span>
<span class=hs-linenum> 11: </span><span class='hs-comment'>-- | Haskell implementation of C bits</span>
<span class=hs-linenum> 12: </span><span class='hs-keyword'>module</span> <span class='hs-conid'>Data.ByteString.Internal.Pure</span>
<span class=hs-linenum> 13: </span>  <span class='hs-layout'>(</span> <span class='hs-comment'>-- * standard string.h functions</span>
<span class=hs-linenum> 14: </span>    <span class='hs-varid'>strlen</span>
<span class=hs-linenum> 15: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>memchr</span>
<span class=hs-linenum> 16: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>memcmp</span>
<span class=hs-linenum> 17: </span>    <span class='hs-comment'>-- * fpstring.c</span>
<span class=hs-linenum> 18: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>intersperse</span>
<span class=hs-linenum> 19: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>countOcc</span>
<span class=hs-linenum> 20: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>countOccBA</span>
<span class=hs-linenum> 21: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>reverseBytes</span>
<span class=hs-linenum> 22: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>findMaximum</span>
<span class=hs-linenum> 23: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>findMinimum</span>
<span class=hs-linenum> 24: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>quickSort</span>
<span class=hs-linenum> 25: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>elemIndex</span>
<span class=hs-linenum> 26: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>isValidUtf8</span>
<span class=hs-linenum> 27: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>isValidUtf8BA</span>
<span class=hs-linenum> 28: </span>  <span class='hs-comment'>-- * itoa.c</span>
<span class=hs-linenum> 29: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>encodeSignedDec</span>
<span class=hs-linenum> 30: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>encodeUnsignedDec</span>
<span class=hs-linenum> 31: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>encodeUnsignedDecPadded</span>
<span class=hs-linenum> 32: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>encodeUnsignedHex</span>
<span class=hs-linenum> 33: </span>  <span class='hs-comment'>-- * static tables (unaligned!)</span>
<span class=hs-linenum> 34: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>lower_hex_table</span>
<span class=hs-linenum> 35: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>digit_pairs_table</span>
<span class=hs-linenum> 36: </span>  <span class='hs-layout'>)</span>
<span class=hs-linenum> 37: </span><span class='hs-keyword'>where</span>
<span class=hs-linenum> 38: </span>
<span class=hs-linenum> 39: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span>
<span class=hs-linenum> 40: </span>
<span class=hs-linenum> 41: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Exts</span>                 <span class='hs-layout'>(</span><span class='hs-conid'>Ptr</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>indexWord8Array</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-conid'>Word8</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-conid'>Int</span><span class='hs-cpp'>#</span><span class='hs-layout'>,</span> <span class='hs-varid'>indexWord8OffAddr</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 42: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Types</span>                <span class='hs-layout'>(</span><span class='hs-conid'>Int</span> <span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 43: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Word</span>                 <span class='hs-layout'>(</span><span class='hs-conid'>Word8</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 44: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC.Int</span>                  <span class='hs-layout'>(</span><span class='hs-conid'>Int8</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 45: </span>
<span class=hs-linenum> 46: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Bits</span>                <span class='hs-layout'>(</span><span class='hs-conid'>Bits</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-varid'>shiftR</span><span class='hs-layout'>,</span> <span class='hs-layout'>(</span><span class='hs-varop'>.&amp;.</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 47: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.Word</span>
<span class=hs-linenum> 48: </span><span class='hs-comment'>-- import Foreign.Ptr              (plusPtr, nullPtr)</span>
<span class=hs-linenum> 49: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.LiquidPtr</span>
<span class=hs-linenum> 50: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Foreign.Storable</span>         <span class='hs-layout'>(</span><span class='hs-conid'>Storable</span><span class='hs-layout'>(</span><span class='hs-keyglyph'>..</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 51: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Control.Monad</span>            <span class='hs-layout'>(</span><span class='hs-varid'>when</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 52: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Control.Exception</span>        <span class='hs-layout'>(</span><span class='hs-varid'>assert</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 53: </span>
<span class=hs-linenum> 54: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.ByteString.Utils.ByteOrder</span>
<span class=hs-linenum> 55: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Data.ByteString.Utils.UnalignedAccess</span>
<span class=hs-linenum> 56: </span>
<span class=hs-linenum> 57: </span><span class='hs-comment'>----------------------------------------------------------------</span>
<span class=hs-linenum> 58: </span><span class='hs-comment'>-- Haskell versions of standard functions in string.h</span>
<span class=hs-linenum> 59: </span><span class='hs-comment'>----------------------------------------------------------------</span>
<span class=hs-linenum> 60: </span>
<span class=hs-linenum> 61: </span><span class='hs-definition'>strlen</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum> 62: </span><a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8) -&gt; (GHC.Types.IO GHC.Types.Int)</span><span class='hs-definition'>strlen</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt;= 0} -&gt; (GHC.Ptr.Ptr GHC.Word.Word8) -&gt; (GHC.Types.IO GHC.Types.Int)</span><span class='hs-varid'>go</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a> <span class='hs-keyword'>where</span>
<span class=hs-linenum> 63: </span>  <span class='hs-keyword'>{-@</span> <span class='hs-varid'>go</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Int</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 64: </span>  <span class='hs-varid'>go</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum> 65: </span>  <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt;= 0} -&gt; (GHC.Ptr.Ptr GHC.Word.Word8) -&gt; (GHC.Types.IO GHC.Types.Int)</span><span class='hs-varid'>go</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt;= 0}</span><span class='hs-varid'>acc</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-varid'>p</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 66: </span>    <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>c</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO GHC.Word.Word8)</span><span class='hs-conid'>Data.LiquidPtr.peek</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p}</span><span class='hs-varid'>p</span></a>
<span class=hs-linenum> 67: </span>    <span class='hs-keyword'>if</span> <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == c}</span><span class='hs-varid'>c</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == acc
                     &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>acc</span></a>
<span class=hs-linenum> 68: </span>       <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>nextAcc</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == acc
                     &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>acc</span></a> <span class='hs-varop'>+</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a>
<span class=hs-linenum> 69: </span>       <span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == nextAcc}</span><span class='hs-varid'>nextAcc</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt;= 0} -&gt; (GHC.Ptr.Ptr GHC.Word.Word8) -&gt; (GHC.Types.IO GHC.Types.Int)</span><span class='hs-varid'>go</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == nextAcc}</span><span class='hs-varid'>nextAcc</span></a> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p}</span><span class='hs-varid'>p</span></a> <span class='hs-varop'>`plusPtr`</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 70: </span>       <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>errorWithoutStackTrace</span>
<span class=hs-linenum> 71: </span>           <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-str'>"bytestring: strlen: String length does not fit in a Haskell Int"</span></a>
<span class=hs-linenum> 72: </span>
<span class=hs-linenum> 73: </span><span class='hs-definition'>memchr</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 74: </span><a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8) -&gt; GHC.Word.Word8 -&gt; GHC.Types.Int -&gt; (GHC.Types.IO (GHC.Ptr.Ptr GHC.Word.Word8))</span><span class='hs-definition'>memchr</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-varid'>p</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>target</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>len</span></a>
<span class=hs-linenum> 75: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == len}</span><span class='hs-varid'>len</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == 0}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>{VV : forall a . {v : (GHC.Ptr.Ptr a) | v == 0} | VV == nullPtr}</span><span class='hs-varid'>nullPtr</span></a>
<span class=hs-linenum> 76: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO (GHC.Ptr.Ptr GHC.Word.Word8)) -&gt; (GHC.Types.IO (GHC.Ptr.Ptr GHC.Word.Word8))</span><span class='hs-varid'>assert</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == len}</span><span class='hs-varid'>len</span></a> <span class='hs-varop'>&gt;</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 77: </span>      <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>c</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO GHC.Word.Word8)</span><span class='hs-conid'>Data.LiquidPtr.peek</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p}</span><span class='hs-varid'>p</span></a>
<span class=hs-linenum> 78: </span>      <span class='hs-keyword'>if</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == c}</span><span class='hs-varid'>c</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == target}</span><span class='hs-varid'>target</span></a>
<span class=hs-linenum> 79: </span>        <span class='hs-keyword'>then</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p}</span><span class='hs-varid'>p</span></a>
<span class=hs-linenum> 80: </span>        <span class='hs-keyword'>else</span> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8) -&gt; GHC.Word.Word8 -&gt; GHC.Types.Int -&gt; (GHC.Types.IO (GHC.Ptr.Ptr GHC.Word.Word8))</span><span class='hs-varid'>memchr</span></a> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p}</span><span class='hs-varid'>p</span></a> <span class='hs-varop'>`plusPtr`</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == target}</span><span class='hs-varid'>target</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == len}</span><span class='hs-varid'>len</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 81: </span>
<span class=hs-linenum> 82: </span><span class='hs-definition'>memcmp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum> 83: </span><a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8) -&gt; (GHC.Ptr.Ptr GHC.Word.Word8) -&gt; GHC.Types.Int -&gt; (GHC.Types.IO GHC.Types.Int)</span><span class='hs-definition'>memcmp</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-varid'>p1</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-varid'>p2</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>len</span></a>
<span class=hs-linenum> 84: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == len}</span><span class='hs-varid'>len</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>8</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum> 85: </span>      <a class=annot href="#"><span class=annottext>GHC.Word.Word64</span><span class='hs-varid'>w1</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO GHC.Word.Word64)</span><span class='hs-varid'>unalignedReadU64</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p1}</span><span class='hs-varid'>p1</span></a>
<span class=hs-linenum> 86: </span>      <a class=annot href="#"><span class=annottext>GHC.Word.Word64</span><span class='hs-varid'>w2</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO GHC.Word.Word64)</span><span class='hs-varid'>unalignedReadU64</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p2}</span><span class='hs-varid'>p2</span></a>
<span class=hs-linenum> 87: </span>      <span class='hs-keyword'>let</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word64 -&gt; GHC.Word.Word64</span><span class='hs-varid'>toBigEndian</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word64 -&gt; GHC.Word.Word64</span><span class='hs-varid'>whenLittleEndian</span></a> <a class=annot href="#"><span class=annottext>GHC.Word.Word64 -&gt; GHC.Word.Word64</span><span class='hs-varid'>byteSwap64</span></a>
<span class=hs-linenum> 88: </span>      <span class='hs-keyword'>if</span> <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word64 | v == w1}</span><span class='hs-varid'>w1</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word64 | v == w2}</span><span class='hs-varid'>w2</span></a>
<span class=hs-linenum> 89: </span>           <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8) -&gt; (GHC.Ptr.Ptr GHC.Word.Word8) -&gt; GHC.Types.Int -&gt; (GHC.Types.IO GHC.Types.Int)</span><span class='hs-varid'>memcmp</span></a> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p1}</span><span class='hs-varid'>p1</span></a> <span class='hs-varop'>`plusPtr`</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>8</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p2}</span><span class='hs-varid'>p2</span></a> <span class='hs-varop'>`plusPtr`</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>8</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == len}</span><span class='hs-varid'>len</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>8</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 90: </span>         <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word64</span><span class='hs-varid'>toBigEndian</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word64 | v == w1}</span><span class='hs-varid'>w1</span></a> <span class='hs-varop'>&lt;</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word64</span><span class='hs-varid'>toBigEndian</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word64 | v == w2}</span><span class='hs-varid'>w2</span></a>
<span class=hs-linenum> 91: </span>           <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum> 92: </span>         <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a>
<span class=hs-linenum> 93: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8) -&gt; (GHC.Ptr.Ptr GHC.Word.Word8) -&gt; GHC.Types.Int -&gt; (GHC.Types.IO GHC.Types.Int)</span><span class='hs-varid'>memcmp1</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p1}</span><span class='hs-varid'>p1</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p2}</span><span class='hs-varid'>p2</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == len}</span><span class='hs-varid'>len</span></a>
<span class=hs-linenum> 94: </span>
<span class=hs-linenum> 95: </span><span class='hs-comment'>-- | Like 'memcmp', but definitely scans one byte at a time</span>
<span class=hs-linenum> 96: </span><span class='hs-definition'>memcmp1</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum> 97: </span><a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8) -&gt; (GHC.Ptr.Ptr GHC.Word.Word8) -&gt; GHC.Types.Int -&gt; (GHC.Types.IO GHC.Types.Int)</span><span class='hs-definition'>memcmp1</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-varid'>p1</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-varid'>p2</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>len</span></a>
<span class=hs-linenum> 98: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == len}</span><span class='hs-varid'>len</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a>
<span class=hs-linenum> 99: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO GHC.Types.Int) -&gt; (GHC.Types.IO GHC.Types.Int)</span><span class='hs-varid'>assert</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == len}</span><span class='hs-varid'>len</span></a> <span class='hs-varop'>&gt;</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>100: </span>      <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>c1</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO GHC.Word.Word8)</span><span class='hs-conid'>Data.LiquidPtr.peek</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p1}</span><span class='hs-varid'>p1</span></a>
<span class=hs-linenum>101: </span>      <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>c2</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO GHC.Word.Word8)</span><span class='hs-conid'>Data.LiquidPtr.peek</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p2}</span><span class='hs-varid'>p2</span></a>
<span class=hs-linenum>102: </span>      <span class='hs-keyword'>if</span> <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == c1}</span><span class='hs-varid'>c1</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == c2}</span><span class='hs-varid'>c2</span></a> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8) -&gt; (GHC.Ptr.Ptr GHC.Word.Word8) -&gt; GHC.Types.Int -&gt; (GHC.Types.IO GHC.Types.Int)</span><span class='hs-varid'>memcmp1</span></a> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p1}</span><span class='hs-varid'>p1</span></a> <span class='hs-varop'>`plusPtr`</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p2}</span><span class='hs-varid'>p2</span></a> <span class='hs-varop'>`plusPtr`</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == len}</span><span class='hs-varid'>len</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>103: </span>         <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == c1}</span><span class='hs-varid'>c1</span></a> <span class='hs-varop'>&lt;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == c2}</span><span class='hs-varid'>c2</span></a>   <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>104: </span>         <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a>
<span class=hs-linenum>105: </span>
<span class=hs-linenum>106: </span>
<span class=hs-linenum>107: </span><span class='hs-comment'>----------------------------------------------------------------</span>
<span class=hs-linenum>108: </span><span class='hs-comment'>-- Haskell versions of functions in fpstring.c</span>
<span class=hs-linenum>109: </span><span class='hs-comment'>----------------------------------------------------------------</span>
<span class=hs-linenum>110: </span>
<span class=hs-linenum>111: </span><span class='hs-comment'>-- | duplicate a string, interspersing the character through the elements of the</span>
<span class=hs-linenum>112: </span><span class='hs-comment'>-- duplicated string</span>
<span class=hs-linenum>113: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>intersperse</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{dp:</span><span class='hs-layout'>(</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span> <span class='hs-keyword'>| PtrValid dp}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{sp:</span><span class='hs-layout'>(</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span> <span class='hs-keyword'>|PtrValid sp}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{n:</span><span class='hs-conid'>Nat</span> <span class='hs-keyword'>| PtrValidN dp n}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>114: </span><span class='hs-definition'>intersperse</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>115: </span><a class=annot href="#"><span class=annottext>x1:{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                        &amp;&amp; pbase VV &lt;= VV} -&gt; {VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                                                                                   &amp;&amp; pbase VV &lt;= VV} -&gt; {VV : GHC.Types.Int | VV &gt;= 0
                                                                                                                                               &amp;&amp; VV &lt; (pbase x1 + plen (pbase x1)) - x1
                                                                                                                                               &amp;&amp; pbase x1 &lt;= x1} -&gt; GHC.Word.Word8 -&gt; (GHC.Types.IO ())</span><span class='hs-definition'>intersperse</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                     &amp;&amp; pbase VV &lt;= VV}</span><span class='hs-varid'>dst</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                     &amp;&amp; pbase VV &lt;= VV}</span><span class='hs-varid'>src</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt;= 0
                      &amp;&amp; VV &lt; (pbase dst + plen (pbase dst)) - dst
                      &amp;&amp; pbase dst &lt;= dst}</span><span class='hs-varid'>len</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>w</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == len
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt; (pbase dst + plen (pbase dst)) - dst
                     &amp;&amp; pbase dst &lt;= dst}</span><span class='hs-varid'>len</span></a> <span class='hs-keyword'>of</span>
<span class=hs-linenum>116: </span>  <span class='hs-num'>0</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>{v : () | v == ()}</span><span class='hs-conid'>()</span></a>
<span class=hs-linenum>117: </span>  <span class='hs-num'>1</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>118: </span>    <span class='hs-comment'>-- copy last char</span>
<span class=hs-linenum>119: </span>    <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>c</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO GHC.Word.Word8)</span><span class='hs-conid'>Data.LiquidPtr.peekByteOff</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == src
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>src</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>120: </span>    <a class=annot href="#"><span class=annottext>{v : (Foreign.Storable.Storable GHC.Word.Word8) | v == $fStorableWord8}</span><span class='hs-conid'>Data.LiquidPtr.pokeByteOff</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == dst
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>dst</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == c}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>c</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>121: </span>  <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>122: </span>    <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>c</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO GHC.Word.Word8)</span><span class='hs-conid'>Data.LiquidPtr.peekByteOff</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == src
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>src</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>123: </span>    <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-conid'>Data.LiquidPtr.pokeByteOff</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == dst
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>dst</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == c}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>c</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>124: </span>    <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-conid'>Data.LiquidPtr.pokeByteOff</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == dst
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>dst</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == w}</span><span class='hs-varid'>w</span></a>
<span class=hs-linenum>125: </span>    <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-varid'>intersperse</span></a> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>plusPtr</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == dst
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>dst</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>plusPtr</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == src
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>src</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == len
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt; (pbase dst + plen (pbase dst)) - dst
                     &amp;&amp; pbase dst &lt;= dst}</span><span class='hs-varid'>len</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == w}</span><span class='hs-varid'>w</span></a>
<span class=hs-linenum>126: </span>
<span class=hs-linenum>127: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>countOccBA</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{n:</span><span class='hs-conid'>Int</span> <span class='hs-keyword'>| n &gt; 0}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Int</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>128: </span><span class='hs-definition'>countOccBA</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>129: </span><a class=annot href="#"><span class=annottext>GHC.Prim.ByteArray# -&gt; {n : GHC.Types.Int | n &gt; 0} -&gt; GHC.Word.Word8 -&gt; (GHC.Types.IO GHC.Types.Int)</span><span class='hs-definition'>countOccBA</span></a> <a class=annot href="#"><span class=annottext>GHC.Prim.ByteArray#</span><span class='hs-varid'>ba</span></a> <a class=annot href="#"><span class=annottext>{n : GHC.Types.Int | n &gt; 0}</span><span class='hs-varid'>len</span></a> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>w</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><span class='hs-varid'>go</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>130: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>131: </span>    <span class='hs-keyword'>{-@</span> <span class='hs-varid'>go</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>n</span><span class='hs-conop'>:</span><span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>i</span><span class='hs-conop'>:</span><span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-varop'>/</span> <span class='hs-keyglyph'>[</span> <span class='hs-varid'>n</span> <span class='hs-comment'>-</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>]</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>132: </span>    <span class='hs-varid'>go</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>133: </span>    <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt;= 0} -&gt; {VV : GHC.Types.Int | VV &gt;= 0} -&gt; GHC.Types.Int</span><span class='hs-varid'>go</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt;= 0}</span><span class='hs-varid'>n</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt;= 0}</span><span class='hs-varid'>i</span></a><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>I</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<span class=hs-linenum>134: </span>      <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v == i#
                     &amp;&amp; v == (i# : int)
                     &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>i</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == len
                     &amp;&amp; v &gt; 0}</span><span class='hs-varid'>len</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n
                     &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>n</span></a>
<span class=hs-linenum>135: </span>      <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-conid'>W8</span></a><span class='hs-cpp'>#</span> <a class=annot href="#"><span class=annottext>GHC.Prim.Word8#</span><span class='hs-layout'>(</span></a><span class='hs-varid'>indexWord8Array</span><span class='hs-cpp'>#</span> <a class=annot href="#"><span class=annottext>{v : GHC.Prim.ByteArray# | v == ba}</span><span class='hs-varid'>ba</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Prim.Int# | v == i#}</span><span class='hs-varid'>i</span></a><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == w}</span><span class='hs-varid'>w</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt;= 0} -&gt; {VV : GHC.Types.Int | VV &gt;= 0} -&gt; GHC.Types.Int</span><span class='hs-varid'>go</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n
                     &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>n</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>i</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>136: </span>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt;= 0} -&gt; {VV : GHC.Types.Int | VV &gt;= 0} -&gt; GHC.Types.Int</span><span class='hs-varid'>go</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n
                     &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>n</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v == i#
                     &amp;&amp; v == (i# : int)
                     &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>i</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>137: </span>
<span class=hs-linenum>138: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>countOcc</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{p:</span><span class='hs-layout'>(</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span> <span class='hs-keyword'>| PtrValid p}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{n:</span><span class='hs-conid'>Nat</span> <span class='hs-keyword'>| PtrValidN p n}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Int</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>139: </span><span class='hs-definition'>countOcc</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>140: </span><a class=annot href="#"><span class=annottext>x1:{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                        &amp;&amp; pbase VV &lt;= VV} -&gt; {VV : GHC.Types.Int | VV &gt;= 0
                                                                                    &amp;&amp; VV &lt; (pbase x1 + plen (pbase x1)) - x1
                                                                                    &amp;&amp; pbase x1 &lt;= x1} -&gt; GHC.Word.Word8 -&gt; (GHC.Types.IO GHC.Types.Int)</span><span class='hs-definition'>countOcc</span></a> <a class=annot href="#"><span class=annottext>{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                     &amp;&amp; pbase VV &lt;= VV}</span><span class='hs-varid'>p</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt;= 0
                      &amp;&amp; VV &lt; (pbase p + plen (pbase p)) - p
                      &amp;&amp; pbase p &lt;= p}</span><span class='hs-varid'>len</span></a> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>w</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Num.Num GHC.Types.Int) | v == $fNumInt}</span><span class='hs-varid'>go</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>141: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>142: </span>    <a class=annot href="#"><span class=annottext>{VV : a | VV &gt;= 0} -&gt; {VV : GHC.Types.Int | VV &gt;= 0
                                            &amp;&amp; VV &lt; (pbase p + plen (pbase p)) - p
                                            &amp;&amp; VV &lt;= len
                                            &amp;&amp; pbase p &lt;= p} -&gt; (GHC.Types.IO a)</span><span class='hs-varid'>go</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : a | VV &gt;= 0}</span><span class='hs-varid'>n</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt;= 0
                      &amp;&amp; VV &lt; (pbase p + plen (pbase p)) - p
                      &amp;&amp; VV &lt;= len
                      &amp;&amp; pbase p &lt;= p}</span><span class='hs-varid'>i</span></a>
<span class=hs-linenum>143: </span>      <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt; (pbase p + plen (pbase p)) - p
                     &amp;&amp; v &lt;= len
                     &amp;&amp; pbase p &lt;= p}</span><span class='hs-varid'>i</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == len
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt; (pbase p + plen (pbase p)) - p
                     &amp;&amp; pbase p &lt;= p}</span><span class='hs-varid'>len</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == n
          &amp;&amp; VV &gt;= 0}</span><span class='hs-varid'>n</span></a>
<span class=hs-linenum>144: </span>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>145: </span>          <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>c</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO GHC.Word.Word8)</span><span class='hs-conid'>Data.LiquidPtr.peekByteOff</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>p</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt; (pbase p + plen (pbase p)) - p
                     &amp;&amp; v &lt;= len
                     &amp;&amp; pbase p &lt;= p}</span><span class='hs-varid'>i</span></a>
<span class=hs-linenum>146: </span>          <span class='hs-keyword'>if</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == c}</span><span class='hs-varid'>c</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == w}</span><span class='hs-varid'>w</span></a>
<span class=hs-linenum>147: </span>            <span class='hs-keyword'>then</span> <a class=annot href="#"><span class=annottext>{VV : a | VV &gt;= 0} -&gt; {VV : GHC.Types.Int | VV &gt;= 0
                                            &amp;&amp; VV &lt; (pbase p + plen (pbase p)) - p
                                            &amp;&amp; VV &lt;= len
                                            &amp;&amp; pbase p &lt;= p} -&gt; (GHC.Types.IO a)</span><span class='hs-varid'>go</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{VV : a | VV == n
          &amp;&amp; VV &gt;= 0}</span><span class='hs-varid'>n</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>a</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt; (pbase p + plen (pbase p)) - p
                     &amp;&amp; v &lt;= len
                     &amp;&amp; pbase p &lt;= p}</span><span class='hs-varid'>i</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>148: </span>            <span class='hs-keyword'>else</span> <a class=annot href="#"><span class=annottext>{VV : a | VV &gt;= 0} -&gt; {VV : GHC.Types.Int | VV &gt;= 0
                                            &amp;&amp; VV &lt; (pbase p + plen (pbase p)) - p
                                            &amp;&amp; VV &lt;= len
                                            &amp;&amp; pbase p &lt;= p} -&gt; (GHC.Types.IO a)</span><span class='hs-varid'>go</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == n
          &amp;&amp; VV &gt;= 0}</span><span class='hs-varid'>n</span></a>     <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt; (pbase p + plen (pbase p)) - p
                     &amp;&amp; v &lt;= len
                     &amp;&amp; pbase p &lt;= p}</span><span class='hs-varid'>i</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>149: </span>
<span class=hs-linenum>150: </span><span class='hs-comment'>-- | Haskell equivalent of C `sbs_elem_index`</span>
<span class=hs-linenum>151: </span><span class='hs-definition'>elemIndex</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>152: </span><a class=annot href="#"><span class=annottext>GHC.Prim.ByteArray# -&gt; GHC.Word.Word8 -&gt; GHC.Types.Int -&gt; (GHC.Types.IO GHC.Types.Int)</span><span class='hs-definition'>elemIndex</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>GHC.Prim.ByteArray#</span><span class='hs-varid'>ba</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>w</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>len</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><span class='hs-varid'>go</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>153: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>154: </span>    <a class=annot href="#"><span class=annottext>GHC.Types.Int -&gt; GHC.Types.Int</span><span class='hs-varid'>go</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>i</span></a><span class='hs-keyglyph'>@</span><span class='hs-layout'>(</span><span class='hs-conid'>I</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span>
<span class=hs-linenum>155: </span>      <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v == i#
                     &amp;&amp; v == (i# : int)}</span><span class='hs-varid'>i</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == len}</span><span class='hs-varid'>len</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Num.Num GHC.Types.Int) | v == $fNumInt}</span><span class='hs-comment'>-</span></a><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a>
<span class=hs-linenum>156: </span>      <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-conid'>W8</span></a><span class='hs-cpp'>#</span> <a class=annot href="#"><span class=annottext>GHC.Prim.Word8#</span><span class='hs-layout'>(</span></a><span class='hs-varid'>indexWord8Array</span><span class='hs-cpp'>#</span> <a class=annot href="#"><span class=annottext>{v : GHC.Prim.ByteArray# | v == ba}</span><span class='hs-varid'>ba</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Prim.Int# | v == i#}</span><span class='hs-varid'>i</span></a><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == w}</span><span class='hs-varid'>w</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i}</span><span class='hs-varid'>i</span></a>
<span class=hs-linenum>157: </span>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int -&gt; GHC.Types.Int</span><span class='hs-varid'>go</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v == i#
                     &amp;&amp; v == (i# : int)}</span><span class='hs-varid'>i</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>158: </span>
<span class=hs-linenum>159: </span><span class='hs-comment'>-- | Reverse n-bytes from the second pointer into the first</span>
<span class=hs-linenum>160: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reverseBytes</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{p:</span><span class='hs-layout'>(</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span> <span class='hs-keyword'>| PtrValid p}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{m:</span><span class='hs-layout'>(</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span> <span class='hs-keyword'>| PtrValid m}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{i:</span><span class='hs-conid'>Nat</span> <span class='hs-keyword'>| PtrValidN p i &amp;&amp; PtrValidN m i}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>161: </span><span class='hs-definition'>reverseBytes</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>162: </span><a class=annot href="#"><span class=annottext>x1:{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                        &amp;&amp; pbase VV &lt;= VV} -&gt; x2:{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                                                                                      &amp;&amp; pbase VV &lt;= VV} -&gt; {VV : GHC.Types.Int | VV &gt;= 0
                                                                                                                                                  &amp;&amp; VV &lt; (pbase x1 + plen (pbase x1)) - x1
                                                                                                                                                  &amp;&amp; VV &lt; (pbase x2 + plen (pbase x2)) - x2
                                                                                                                                                  &amp;&amp; pbase x1 &lt;= x1
                                                                                                                                                  &amp;&amp; pbase x2 &lt;= x2} -&gt; (GHC.Types.IO ())</span><span class='hs-definition'>reverseBytes</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                     &amp;&amp; pbase VV &lt;= VV}</span><span class='hs-varid'>dst</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                     &amp;&amp; pbase VV &lt;= VV}</span><span class='hs-varid'>src</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt;= 0
                      &amp;&amp; VV &lt; (pbase dst + plen (pbase dst)) - dst
                      &amp;&amp; VV &lt; (pbase src + plen (pbase src)) - src
                      &amp;&amp; pbase dst &lt;= dst
                      &amp;&amp; pbase src &lt;= src}</span><span class='hs-varid'>n</span></a>
<span class=hs-linenum>163: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt; (pbase dst + plen (pbase dst)) - dst
                     &amp;&amp; v &lt; (pbase src + plen (pbase src)) - src
                     &amp;&amp; pbase dst &lt;= dst
                     &amp;&amp; pbase src &lt;= src}</span><span class='hs-varid'>n</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>{v : () | v == ()}</span><span class='hs-conid'>()</span></a>
<span class=hs-linenum>164: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                     &amp;&amp; pbase VV &lt;= VV} -&gt; {VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                                                                                &amp;&amp; pbase VV &lt;= VV} -&gt; {VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                                                                                                                                           &amp;&amp; pbase VV &lt;= VV} -&gt; (GHC.Types.IO ())</span><span class='hs-varid'>reverse_bytes</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == dst
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>dst</span></a> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>plusPtr</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == dst
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>dst</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt; (pbase dst + plen (pbase dst)) - dst
                     &amp;&amp; v &lt; (pbase src + plen (pbase src)) - src
                     &amp;&amp; pbase dst &lt;= dst
                     &amp;&amp; pbase src &lt;= src}</span><span class='hs-varid'>n</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == src
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>src</span></a>
<span class=hs-linenum>165: </span>
<span class=hs-linenum>166: </span><span class='hs-comment'>-- | Note that reverse_bytes reverses at least one byte.</span>
<span class=hs-linenum>167: </span><span class='hs-comment'>-- Then it loops if necessary until the destination buffer is full</span>
<span class=hs-linenum>168: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>reverse_bytes</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{odptr:</span><span class='hs-layout'>(</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span> <span class='hs-keyword'>| PtrValid odptr}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{dptr:</span><span class='hs-layout'>(</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span> <span class='hs-keyword'>| PtrValid dptr}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{sptr:</span><span class='hs-layout'>(</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span> <span class='hs-keyword'>| PtrValid sptr}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>169: </span><span class='hs-definition'>reverse_bytes</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>170: </span><a class=annot href="#"><span class=annottext>{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                     &amp;&amp; pbase VV &lt;= VV} -&gt; {VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                                                                                &amp;&amp; pbase VV &lt;= VV} -&gt; {VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                                                                                                                                           &amp;&amp; pbase VV &lt;= VV} -&gt; (GHC.Types.IO ())</span><span class='hs-definition'>reverse_bytes</span></a> <a class=annot href="#"><span class=annottext>{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                     &amp;&amp; pbase VV &lt;= VV}</span><span class='hs-varid'>orig_dst</span></a> <a class=annot href="#"><span class=annottext>{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                     &amp;&amp; pbase VV &lt;= VV}</span><span class='hs-varid'>dst</span></a> <a class=annot href="#"><span class=annottext>{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                     &amp;&amp; pbase VV &lt;= VV}</span><span class='hs-varid'>src</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>171: </span>  <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>c</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO GHC.Word.Word8)</span><span class='hs-conid'>Data.LiquidPtr.peekByteOff</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == src
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>src</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>172: </span>  <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-conid'>Data.LiquidPtr.pokeByteOff</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == dst
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>dst</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == c}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>c</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>173: </span>  <span class='hs-keyword'>if</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == orig_dst
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>orig_dst</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == dst
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>dst</span></a>
<span class=hs-linenum>174: </span>    <span class='hs-keyword'>then</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>{v : () | v == ()}</span><span class='hs-conid'>()</span></a>
<span class=hs-linenum>175: </span>    <span class='hs-keyword'>else</span> <a class=annot href="#"><span class=annottext>{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                     &amp;&amp; pbase VV &lt;= VV} -&gt; {VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                                                                                &amp;&amp; pbase VV &lt;= VV} -&gt; {VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                                                                                                                                           &amp;&amp; pbase VV &lt;= VV} -&gt; (GHC.Types.IO ())</span><span class='hs-varid'>reverse_bytes</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == orig_dst
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>orig_dst</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | pbase v == pbase dst
                                    &amp;&amp; v &lt; dst}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>plusPtr</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == dst
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>dst</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | pbase v == pbase src
                                    &amp;&amp; v &lt; src}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>plusPtr</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == src
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>src</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>176: </span>
<span class=hs-linenum>177: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>findMaximum</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{p:</span><span class='hs-layout'>(</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span> <span class='hs-keyword'>| PtrValid p}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{n:</span><span class='hs-conid'>Nat</span> <span class='hs-keyword'>| PtrValidN p n &amp;&amp; n &gt; 0}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Word8</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>178: </span><span class='hs-definition'>findMaximum</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Word8</span>
<span class=hs-linenum>179: </span><a class=annot href="#"><span class=annottext>x1:{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                        &amp;&amp; pbase VV &lt;= VV} -&gt; {VV : GHC.Types.Int | VV &gt; 0
                                                                                    &amp;&amp; VV &gt;= 0
                                                                                    &amp;&amp; VV &lt; (pbase x1 + plen (pbase x1)) - x1
                                                                                    &amp;&amp; pbase x1 &lt;= x1} -&gt; (GHC.Types.IO GHC.Word.Word8)</span><span class='hs-definition'>findMaximum</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                     &amp;&amp; pbase VV &lt;= VV}</span><span class='hs-varid'>p</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt; 0
                      &amp;&amp; VV &gt;= 0
                      &amp;&amp; VV &lt; (pbase p + plen (pbase p)) - p
                      &amp;&amp; pbase p &lt;= p}</span><span class='hs-varid'>n</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO GHC.Word.Word8) -&gt; (GHC.Types.IO GHC.Word.Word8)</span><span class='hs-varid'>assert</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n
                     &amp;&amp; v &gt; 0
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt; (pbase p + plen (pbase p)) - p
                     &amp;&amp; pbase p &lt;= p}</span><span class='hs-varid'>n</span></a> <span class='hs-varop'>&gt;</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO GHC.Word.Word8)</span><span class='hs-varid'>find_maximum</span></a> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>minBound</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>p</span></a> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>plusPtr</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>p</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n
                     &amp;&amp; v &gt; 0
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt; (pbase p + plen (pbase p)) - p
                     &amp;&amp; pbase p &lt;= p}</span><span class='hs-varid'>n</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>180: </span>
<span class=hs-linenum>181: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>find_maximum</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{m:</span><span class='hs-layout'>(</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span> <span class='hs-keyword'>| PtrValid m}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{p:</span><span class='hs-layout'>(</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span> <span class='hs-keyword'>| PtrValid p}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Word8</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>182: </span><span class='hs-definition'>find_maximum</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Word8</span>
<span class=hs-linenum>183: </span><a class=annot href="#"><span class=annottext>GHC.Word.Word8 -&gt; {VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                                       &amp;&amp; pbase VV &lt;= VV} -&gt; {VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                                                                                                  &amp;&amp; pbase VV &lt;= VV} -&gt; (GHC.Types.IO GHC.Word.Word8)</span><span class='hs-definition'>find_maximum</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>m</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                     &amp;&amp; pbase VV &lt;= VV}</span><span class='hs-varid'>p</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                     &amp;&amp; pbase VV &lt;= VV}</span><span class='hs-varid'>plast</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>184: </span>  <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>c</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO GHC.Word.Word8)</span><span class='hs-conid'>Data.LiquidPtr.peekByteOff</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>p</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>185: </span>  <span class='hs-keyword'>let</span> <span class='hs-varop'>!</span><span class='hs-varid'>c'</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : GHC.Word.Word8 | VV &gt;= c
                       &amp;&amp; VV &gt;= m
                       &amp;&amp; pbase p &lt;= p
                       &amp;&amp; pbase plast &lt;= plast}</span><span class='hs-keyword'>if</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == c}</span><span class='hs-varid'>c</span></a> <span class='hs-varop'>&gt;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == m}</span><span class='hs-varid'>m</span></a> <span class='hs-keyword'>then</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == c}</span><span class='hs-varid'>c</span></a> <span class='hs-keyword'>else</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == m}</span><span class='hs-varid'>m</span></a>
<span class=hs-linenum>186: </span>  <span class='hs-keyword'>if</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>p</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == plast
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>plast</span></a>
<span class=hs-linenum>187: </span>    <span class='hs-keyword'>then</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v &gt;= c
                      &amp;&amp; v &gt;= m
                      &amp;&amp; pbase p &lt;= p
                      &amp;&amp; pbase plast &lt;= plast}</span><span class='hs-varid'>c'</span></a>
<span class=hs-linenum>188: </span>    <span class='hs-keyword'>else</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8 -&gt; {VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                                       &amp;&amp; pbase VV &lt;= VV} -&gt; {VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                                                                                                  &amp;&amp; pbase VV &lt;= VV} -&gt; (GHC.Types.IO GHC.Word.Word8)</span><span class='hs-varid'>find_maximum</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v &gt;= c
                      &amp;&amp; v &gt;= m
                      &amp;&amp; pbase p &lt;= p
                      &amp;&amp; pbase plast &lt;= plast}</span><span class='hs-varid'>c'</span></a> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>plusPtr</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>p</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == plast
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>plast</span></a>
<span class=hs-linenum>189: </span>
<span class=hs-linenum>190: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>findMinimum</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{p:</span><span class='hs-layout'>(</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span> <span class='hs-keyword'>| PtrValid p}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{n:</span><span class='hs-conid'>Nat</span> <span class='hs-keyword'>| PtrValidN p n &amp;&amp; n &gt; 0}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Word8</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>191: </span><span class='hs-definition'>findMinimum</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Word8</span>
<span class=hs-linenum>192: </span><a class=annot href="#"><span class=annottext>x1:{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                        &amp;&amp; pbase VV &lt;= VV} -&gt; {VV : GHC.Types.Int | VV &gt; 0
                                                                                    &amp;&amp; VV &gt;= 0
                                                                                    &amp;&amp; VV &lt; (pbase x1 + plen (pbase x1)) - x1
                                                                                    &amp;&amp; pbase x1 &lt;= x1} -&gt; (GHC.Types.IO GHC.Word.Word8)</span><span class='hs-definition'>findMinimum</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                     &amp;&amp; pbase VV &lt;= VV}</span><span class='hs-varid'>p</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt; 0
                      &amp;&amp; VV &gt;= 0
                      &amp;&amp; VV &lt; (pbase p + plen (pbase p)) - p
                      &amp;&amp; pbase p &lt;= p}</span><span class='hs-varid'>n</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO GHC.Word.Word8) -&gt; (GHC.Types.IO GHC.Word.Word8)</span><span class='hs-varid'>assert</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n
                     &amp;&amp; v &gt; 0
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt; (pbase p + plen (pbase p)) - p
                     &amp;&amp; pbase p &lt;= p}</span><span class='hs-varid'>n</span></a> <span class='hs-varop'>&gt;</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO GHC.Word.Word8)</span><span class='hs-varid'>find_minimum</span></a> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>maxBound</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>p</span></a> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>plusPtr</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>p</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == n
                     &amp;&amp; v &gt; 0
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt; (pbase p + plen (pbase p)) - p
                     &amp;&amp; pbase p &lt;= p}</span><span class='hs-varid'>n</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>193: </span>
<span class=hs-linenum>194: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>find_minimum</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{m:</span><span class='hs-layout'>(</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span> <span class='hs-keyword'>| PtrValid m}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{p:</span><span class='hs-layout'>(</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span> <span class='hs-keyword'>| PtrValid p}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Word8</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>195: </span><span class='hs-definition'>find_minimum</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Word8</span>
<span class=hs-linenum>196: </span><a class=annot href="#"><span class=annottext>GHC.Word.Word8 -&gt; {VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                                       &amp;&amp; pbase VV &lt;= VV} -&gt; {VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                                                                                                  &amp;&amp; pbase VV &lt;= VV} -&gt; (GHC.Types.IO GHC.Word.Word8)</span><span class='hs-definition'>find_minimum</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>m</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                     &amp;&amp; pbase VV &lt;= VV}</span><span class='hs-varid'>p</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                     &amp;&amp; pbase VV &lt;= VV}</span><span class='hs-varid'>plast</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>197: </span>  <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>c</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO GHC.Word.Word8)</span><span class='hs-conid'>Data.LiquidPtr.peekByteOff</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>p</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>198: </span>  <span class='hs-keyword'>let</span> <span class='hs-varop'>!</span><span class='hs-varid'>c'</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : GHC.Word.Word8 | VV &lt;= c
                       &amp;&amp; VV &lt;= m
                       &amp;&amp; pbase p &lt;= p
                       &amp;&amp; pbase plast &lt;= plast}</span><span class='hs-keyword'>if</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == c}</span><span class='hs-varid'>c</span></a> <span class='hs-varop'>&lt;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == m}</span><span class='hs-varid'>m</span></a> <span class='hs-keyword'>then</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == c}</span><span class='hs-varid'>c</span></a> <span class='hs-keyword'>else</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == m}</span><span class='hs-varid'>m</span></a>
<span class=hs-linenum>199: </span>  <span class='hs-keyword'>if</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>p</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == plast
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>plast</span></a>
<span class=hs-linenum>200: </span>    <span class='hs-keyword'>then</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v &lt;= c
                      &amp;&amp; v &lt;= m
                      &amp;&amp; pbase p &lt;= p
                      &amp;&amp; pbase plast &lt;= plast}</span><span class='hs-varid'>c'</span></a>
<span class=hs-linenum>201: </span>    <span class='hs-keyword'>else</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8 -&gt; {VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                                       &amp;&amp; pbase VV &lt;= VV} -&gt; {VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                                                                                                  &amp;&amp; pbase VV &lt;= VV} -&gt; (GHC.Types.IO GHC.Word.Word8)</span><span class='hs-varid'>find_minimum</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v &lt;= c
                      &amp;&amp; v &lt;= m
                      &amp;&amp; pbase p &lt;= p
                      &amp;&amp; pbase plast &lt;= plast}</span><span class='hs-varid'>c'</span></a> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>plusPtr</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>p</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == plast
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>plast</span></a>
<span class=hs-linenum>202: </span>
<span class=hs-linenum>203: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>ignore</span> <span class='hs-varid'>quickSort</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>204: </span><span class='hs-definition'>quickSort</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>205: </span><span class='hs-definition'>quickSort</span> <span class='hs-varop'>!</span><span class='hs-varid'>p</span> <span class='hs-varop'>!</span><span class='hs-varid'>n</span>
<span class=hs-linenum>206: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>n</span> <span class='hs-varop'>&lt;=</span> <span class='hs-num'>0</span>    <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pure</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>207: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>quick_sort</span> <span class='hs-varid'>p</span> <span class='hs-num'>0</span> <span class='hs-layout'>(</span><span class='hs-varid'>n</span> <span class='hs-comment'>-</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>208: </span>
<span class=hs-linenum>209: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>ignore</span> <span class='hs-varid'>quick_sort</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>210: </span><span class='hs-definition'>quick_sort</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>211: </span><span class='hs-definition'>quick_sort</span> <span class='hs-varop'>!</span><span class='hs-varid'>p</span> <span class='hs-varop'>!</span><span class='hs-varid'>low</span> <span class='hs-varop'>!</span><span class='hs-varid'>high</span>
<span class=hs-linenum>212: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>low</span> <span class='hs-varop'>&gt;=</span> <span class='hs-varid'>high</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pure</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>213: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>   <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>214: </span>    <span class='hs-varid'>pivot_index</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-varid'>partition</span> <span class='hs-varid'>p</span> <span class='hs-varid'>low</span> <span class='hs-varid'>high</span>
<span class=hs-linenum>215: </span>    <span class='hs-varid'>quick_sort</span> <span class='hs-varid'>p</span> <span class='hs-varid'>low</span> <span class='hs-layout'>(</span><span class='hs-varid'>pivot_index</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>216: </span>    <span class='hs-varid'>quick_sort</span> <span class='hs-varid'>p</span> <span class='hs-layout'>(</span><span class='hs-varid'>pivot_index</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>high</span>
<span class=hs-linenum>217: </span>
<span class=hs-linenum>218: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>ignore</span> <span class='hs-varid'>partition</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>219: </span><span class='hs-definition'>partition</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>220: </span><span class='hs-definition'>partition</span> <span class='hs-varop'>!</span><span class='hs-varid'>p</span> <span class='hs-varop'>!</span><span class='hs-varid'>low</span> <span class='hs-varop'>!</span><span class='hs-varid'>high</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>221: </span>  <span class='hs-comment'>-- choose the rightmost element as the pivot</span>
<span class=hs-linenum>222: </span>  <span class='hs-varid'>pivot</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-conid'>Data.LiquidPtr.peekByteOff</span> <span class='hs-varid'>p</span> <span class='hs-varid'>high</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Word8</span>
<span class=hs-linenum>223: </span>  <span class='hs-comment'>-- traverse through all elements.</span>
<span class=hs-linenum>224: </span>  <span class='hs-comment'>-- swap element smaller than pivot at index j with leftmost element at</span>
<span class=hs-linenum>225: </span>  <span class='hs-comment'>-- index i greater than pivot (can be itself if no greater element read yet)</span>
<span class=hs-linenum>226: </span>  <span class='hs-keyword'>let</span> <span class='hs-varid'>go</span> <span class='hs-varop'>!</span><span class='hs-varid'>i</span> <span class='hs-varop'>!</span><span class='hs-varid'>j</span>
<span class=hs-linenum>227: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>j</span> <span class='hs-varop'>&gt;</span> <span class='hs-varid'>high</span>  <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pure</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-comment'>-</span><span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>228: </span>        <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>229: </span>          <span class='hs-varid'>jv</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-conid'>Data.LiquidPtr.peekByteOff</span> <span class='hs-varid'>p</span> <span class='hs-varid'>j</span>
<span class=hs-linenum>230: </span>          <span class='hs-keyword'>if</span> <span class='hs-layout'>(</span><span class='hs-varid'>jv</span> <span class='hs-varop'>&lt;=</span> <span class='hs-varid'>pivot</span><span class='hs-layout'>)</span>
<span class=hs-linenum>231: </span>            <span class='hs-keyword'>then</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>232: </span>              <span class='hs-varid'>when</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span> <span class='hs-varop'>/=</span> <span class='hs-varid'>j</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>233: </span>                <span class='hs-comment'>-- swap values</span>
<span class=hs-linenum>234: </span>                <span class='hs-varid'>iv</span> <span class='hs-keyglyph'>&lt;-</span> <span class='hs-conid'>Data.LiquidPtr.peekByteOff</span> <span class='hs-varid'>p</span> <span class='hs-varid'>i</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Word8</span>
<span class=hs-linenum>235: </span>                <span class='hs-conid'>Data.LiquidPtr.pokeByteOff</span> <span class='hs-varid'>p</span> <span class='hs-varid'>j</span> <span class='hs-varid'>iv</span>
<span class=hs-linenum>236: </span>                <span class='hs-conid'>Data.LiquidPtr.pokeByteOff</span> <span class='hs-varid'>p</span> <span class='hs-varid'>i</span> <span class='hs-varid'>jv</span>
<span class=hs-linenum>237: </span>              <span class='hs-varid'>go</span> <span class='hs-layout'>(</span><span class='hs-varid'>i</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>j</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>238: </span>            <span class='hs-keyword'>else</span>
<span class=hs-linenum>239: </span>              <span class='hs-varid'>go</span> <span class='hs-varid'>i</span> <span class='hs-layout'>(</span><span class='hs-varid'>j</span><span class='hs-varop'>+</span><span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>240: </span>  <span class='hs-varid'>go</span> <span class='hs-varid'>low</span> <span class='hs-varid'>low</span>
<span class=hs-linenum>241: </span>
<span class=hs-linenum>242: </span><span class='hs-definition'>isValidUtf8BA</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>ByteArray</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum>243: </span><a class=annot href="#"><span class=annottext>GHC.Prim.ByteArray# -&gt; GHC.Types.Int -&gt; (GHC.Types.IO GHC.Types.Bool)</span><span class='hs-definition'>isValidUtf8BA</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>GHC.Prim.ByteArray#</span><span class='hs-varid'>ba</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>len'</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>({v : GHC.Prim.Int# | v &gt;= 0} -&gt; GHC.Prim.Word8#) -&gt; GHC.Types.Int -&gt; (GHC.Types.IO GHC.Types.Bool)</span><span class='hs-varid'>isValidUtf8'</span></a> <a class=annot href="#"><span class=annottext>GHC.Prim.Int# -&gt; GHC.Prim.Word8#</span><span class='hs-layout'>(</span></a><span class='hs-varid'>indexWord8Array</span><span class='hs-cpp'>#</span> <a class=annot href="#"><span class=annottext>{v : GHC.Prim.ByteArray# | v == ba}</span><span class='hs-varid'>ba</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == len'}</span><span class='hs-varid'>len'</span></a>
<span class=hs-linenum>244: </span>
<span class=hs-linenum>245: </span><span class='hs-definition'>isValidUtf8</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum>246: </span><a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8) -&gt; GHC.Types.Int -&gt; (GHC.Types.IO GHC.Types.Bool)</span><span class='hs-definition'>isValidUtf8</span></a> <span class='hs-varop'>!</span><span class='hs-layout'>(</span><span class='hs-conid'>Ptr</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>len'</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>({v : GHC.Prim.Int# | v &gt;= 0} -&gt; GHC.Prim.Word8#) -&gt; GHC.Types.Int -&gt; (GHC.Types.IO GHC.Types.Bool)</span><span class='hs-varid'>isValidUtf8'</span></a> <a class=annot href="#"><span class=annottext>GHC.Prim.Int# -&gt; GHC.Prim.Word8#</span><span class='hs-layout'>(</span></a><span class='hs-varid'>indexWord8OffAddr</span><span class='hs-cpp'>#</span> <a class=annot href="#"><span class=annottext>{v : GHC.Prim.Addr# | v == a}</span><span class='hs-varid'>a</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == len'}</span><span class='hs-varid'>len'</span></a>
<span class=hs-linenum>247: </span>
<span class=hs-linenum>248: </span><span class='hs-definition'>isValidUtf8'</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Int</span><span class='hs-cpp'>#</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word8</span><span class='hs-cpp'>#</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum>249: </span><a class=annot href="#"><span class=annottext>({VV : GHC.Prim.Int# | VV &gt;= 0} -&gt; GHC.Prim.Word8#) -&gt; GHC.Types.Int -&gt; (GHC.Types.IO GHC.Types.Bool)</span><span class='hs-definition'>isValidUtf8'</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Prim.Int# | VV &gt;= 0} -&gt; GHC.Prim.Word8#</span><span class='hs-varid'>idx</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>len</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt;= 0} -&gt; (GHC.Types.IO GHC.Types.Bool)</span><span class='hs-varid'>go</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>250: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>251: </span>    <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV /= len
                      &amp;&amp; VV &gt;= 0
                      &amp;&amp; VV &lt; len
                      &amp;&amp; VV &lt;= len} -&gt; GHC.Word.Word8</span><span class='hs-varid'>indexWord8</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>I</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Prim.Word8#</span><span class='hs-conid'>W8</span></a><span class='hs-cpp'>#</span> <a class=annot href="#"><span class=annottext>GHC.Prim.Word8#</span><span class='hs-layout'>(</span></a><span class='hs-varid'>idx</span> <a class=annot href="#"><span class=annottext>{v : GHC.Prim.Int# | v == i}</span><span class='hs-varid'>i</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>252: </span>
<span class=hs-linenum>253: </span>    <span class='hs-varid'>indexIsCont</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum>254: </span>    <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV /= len
                      &amp;&amp; VV &gt;= 0
                      &amp;&amp; VV &lt; len
                      &amp;&amp; VV &lt;= len} -&gt; GHC.Types.Bool</span><span class='hs-varid'>indexIsCont</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV /= len
                      &amp;&amp; VV &gt;= 0
                      &amp;&amp; VV &lt; len
                      &amp;&amp; VV &lt;= len}</span><span class='hs-varid'>i</span></a> <span class='hs-keyglyph'>=</span>
<span class=hs-linenum>255: </span>        <span class='hs-comment'>-- We use a signed comparison to avoid an extra comparison with 0x80,</span>
<span class=hs-linenum>256: </span>        <span class='hs-comment'>-- since _signed_ 0x80 is -128.</span>
<span class=hs-linenum>257: </span>        <span class='hs-keyword'>let</span>
<span class=hs-linenum>258: </span>           <span class='hs-varid'>v</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int8</span>
<span class=hs-linenum>259: </span>           <a class=annot href="#"><span class=annottext>GHC.Int.Int8</span><span class='hs-varid'>v</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Int.Int8</span><span class='hs-varid'>fromIntegral</span></a> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-layout'>(</span></a><span class='hs-varid'>indexWord8</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v /= len
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt; len
                     &amp;&amp; v &lt;= len}</span><span class='hs-varid'>i</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>260: </span>        <span class='hs-keyword'>in</span> <a class=annot href="#"><span class=annottext>{v' : GHC.Int.Int8 | v' == v}</span><span class='hs-varid'>v</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>GHC.Int.Int8</span><span class='hs-layout'>(</span></a><span class='hs-varid'>fromIntegral</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-layout'>(</span></a><span class='hs-num'>0xBF</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>261: </span>
<span class=hs-linenum>262: </span>    <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt;= 0} -&gt; (GHC.Types.IO GHC.Types.Bool)</span><span class='hs-varid'>go</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt;= 0}</span><span class='hs-varid'>i</span></a>
<span class=hs-linenum>263: </span>      <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>i</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == len}</span><span class='hs-varid'>len</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | v
                      &amp;&amp; v == True}</span><span class='hs-conid'>True</span></a> <span class='hs-comment'>-- done</span>
<span class=hs-linenum>264: </span>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>265: </span>            <span class='hs-keyword'>let</span> <span class='hs-varop'>!</span><span class='hs-varid'>b0</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>indexWord8</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>i</span></a>
<span class=hs-linenum>266: </span>            <span class='hs-keyword'>if</span> <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>b0</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-num'>0x7F</span></a> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt;= 0} -&gt; (GHC.Types.IO GHC.Types.Bool)</span><span class='hs-varid'>go</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>i</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <span class='hs-comment'>-- ASCII</span>
<span class=hs-linenum>267: </span>               <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>b0</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-num'>0xC2</span></a> <span class='hs-varop'>&amp;&amp;</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>b0</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-num'>0xDF</span></a> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{n : GHC.Types.Int | n &gt;= 0} -&gt; (GHC.Types.IO GHC.Types.Bool)</span><span class='hs-varid'>go2</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>i</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>268: </span>               <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>b0</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-num'>0xE0</span></a> <span class='hs-varop'>&amp;&amp;</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>b0</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-num'>0xEF</span></a> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV /= 0
                      &amp;&amp; VV &gt; 0
                      &amp;&amp; VV &gt;= 0
                      &amp;&amp; VV &lt;= len} -&gt; {VV : GHC.Word.Word8 | VV /= 0
                                                              &amp;&amp; VV &gt; 0
                                                              &amp;&amp; VV &gt;= 0} -&gt; (GHC.Types.IO GHC.Types.Bool)</span><span class='hs-varid'>go3</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>i</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>b0</span></a>
<span class=hs-linenum>269: </span>               <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>                <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV /= 0
                      &amp;&amp; VV &gt; 0
                      &amp;&amp; VV &gt;= 0
                      &amp;&amp; VV &lt;= len} -&gt; {VV : GHC.Word.Word8 | VV /= 0
                                                              &amp;&amp; VV &gt; 0
                                                              &amp;&amp; VV &gt;= 0} -&gt; (GHC.Types.IO GHC.Types.Bool)</span><span class='hs-varid'>go4</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>i</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>b0</span></a>
<span class=hs-linenum>270: </span>
<span class=hs-linenum>271: </span>    <span class='hs-keyword'>{-@</span> <span class='hs-varid'>go2</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{n:</span><span class='hs-conid'>Int</span> <span class='hs-keyword'>| n &gt;= 0}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Bool</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>272: </span>    <span class='hs-varid'>go2</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>Bool</span>
<span class=hs-linenum>273: </span>    <a class=annot href="#"><span class=annottext>{n : GHC.Types.Int | n &gt;= 0} -&gt; (GHC.Types.IO GHC.Types.Bool)</span><span class='hs-varid'>go2</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{n : GHC.Types.Int | n &gt;= 0}</span><span class='hs-varid'>i</span></a>
<span class=hs-linenum>274: </span>      <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>i</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == len}</span><span class='hs-varid'>len</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | not v
                      &amp;&amp; v == False}</span><span class='hs-conid'>False</span></a>
<span class=hs-linenum>275: </span>      <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-varid'>indexIsCont</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>i</span></a>
<span class=hs-linenum>276: </span>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt;= 0} -&gt; (GHC.Types.IO GHC.Types.Bool)</span><span class='hs-varid'>go</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>i</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>277: </span>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>
<span class=hs-linenum>278: </span>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | not v
                      &amp;&amp; v == False}</span><span class='hs-conid'>False</span></a>
<span class=hs-linenum>279: </span>
<span class=hs-linenum>280: </span>    <span class='hs-comment'>-- {-@ go2 :: {n:Int | n &gt;= 0} -&gt; IO Bool @-}</span>
<span class=hs-linenum>281: </span>    <span class='hs-comment'>-- go2 :: Int -&gt; IO Bool</span>
<span class=hs-linenum>282: </span>    <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV /= 0
                      &amp;&amp; VV &gt; 0
                      &amp;&amp; VV &gt;= 0
                      &amp;&amp; VV &lt;= len} -&gt; {VV : GHC.Word.Word8 | VV /= 0
                                                              &amp;&amp; VV &gt; 0
                                                              &amp;&amp; VV &gt;= 0} -&gt; (GHC.Types.IO GHC.Types.Bool)</span><span class='hs-varid'>go3</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV /= 0
                      &amp;&amp; VV &gt; 0
                      &amp;&amp; VV &gt;= 0
                      &amp;&amp; VV &lt;= len}</span><span class='hs-varid'>i</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : GHC.Word.Word8 | VV /= 0
                       &amp;&amp; VV &gt; 0
                       &amp;&amp; VV &gt;= 0}</span><span class='hs-varid'>b0</span></a>
<span class=hs-linenum>283: </span>      <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v /= 0
                     &amp;&amp; v &gt; 0
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt;= len}</span><span class='hs-varid'>i</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == len}</span><span class='hs-varid'>len</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | not v
                      &amp;&amp; v == False}</span><span class='hs-conid'>False</span></a> <span class='hs-comment'>-- Be careful: i+1 might overflow!</span>
<span class=hs-linenum>284: </span>      <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-varid'>indexIsCont</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v /= 0
                     &amp;&amp; v &gt; 0
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt;= len}</span><span class='hs-varid'>i</span></a>
<span class=hs-linenum>285: </span>      <span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-varid'>indexIsCont</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v /= 0
                     &amp;&amp; v &gt; 0
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt;= len}</span><span class='hs-varid'>i</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>286: </span>      <span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>b1</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>indexWord8</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v /= 0
                     &amp;&amp; v &gt; 0
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt;= len}</span><span class='hs-varid'>i</span></a>
<span class=hs-linenum>287: </span>      <span class='hs-layout'>,</span>    <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == b0
                      &amp;&amp; v /= 0
                      &amp;&amp; v &gt; 0
                      &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>b0</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-num'>0xE0</span></a> <span class='hs-varop'>&amp;&amp;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == b1}</span><span class='hs-varid'>b1</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-num'>0xA0</span></a><span class='hs-layout'>)</span>  <span class='hs-comment'>-- E0, A0..BF, 80..BF</span>
<span class=hs-linenum>288: </span>        <span class='hs-varop'>||</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == b0
                      &amp;&amp; v /= 0
                      &amp;&amp; v &gt; 0
                      &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>b0</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-num'>0xE1</span></a> <span class='hs-varop'>&amp;&amp;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == b0
                      &amp;&amp; v /= 0
                      &amp;&amp; v &gt; 0
                      &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>b0</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-num'>0xEC</span></a><span class='hs-layout'>)</span>  <span class='hs-comment'>-- E1..EC, 80..BF, 80..BF</span>
<span class=hs-linenum>289: </span>        <span class='hs-varop'>||</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == b0
                      &amp;&amp; v /= 0
                      &amp;&amp; v &gt; 0
                      &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>b0</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-num'>0xED</span></a> <span class='hs-varop'>&amp;&amp;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == b1}</span><span class='hs-varid'>b1</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-num'>0x9F</span></a><span class='hs-layout'>)</span>  <span class='hs-comment'>-- ED, 80..9F, 80..BF</span>
<span class=hs-linenum>290: </span>        <span class='hs-varop'>||</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == b0
                      &amp;&amp; v /= 0
                      &amp;&amp; v &gt; 0
                      &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>b0</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-num'>0xEE</span></a> <span class='hs-varop'>&amp;&amp;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == b0
                      &amp;&amp; v /= 0
                      &amp;&amp; v &gt; 0
                      &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>b0</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-num'>0xEF</span></a><span class='hs-layout'>)</span>  <span class='hs-comment'>-- EE..EF, 80..BF, 80..BF</span>
<span class=hs-linenum>291: </span>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt;= 0} -&gt; (GHC.Types.IO GHC.Types.Bool)</span><span class='hs-varid'>go</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v /= 0
                     &amp;&amp; v &gt; 0
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt;= len}</span><span class='hs-varid'>i</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>292: </span>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>
<span class=hs-linenum>293: </span>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | not v
                      &amp;&amp; v == False}</span><span class='hs-conid'>False</span></a>
<span class=hs-linenum>294: </span>
<span class=hs-linenum>295: </span>    <span class='hs-comment'>-- {-@ go4 :: {n:Int | n &gt;= 0} -&gt; IO Bool @-}</span>
<span class=hs-linenum>296: </span>    <span class='hs-comment'>-- go4 :: Int -&gt; IO Bool</span>
<span class=hs-linenum>297: </span>    <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV /= 0
                      &amp;&amp; VV &gt; 0
                      &amp;&amp; VV &gt;= 0
                      &amp;&amp; VV &lt;= len} -&gt; {VV : GHC.Word.Word8 | VV /= 0
                                                              &amp;&amp; VV &gt; 0
                                                              &amp;&amp; VV &gt;= 0} -&gt; (GHC.Types.IO GHC.Types.Bool)</span><span class='hs-varid'>go4</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV /= 0
                      &amp;&amp; VV &gt; 0
                      &amp;&amp; VV &gt;= 0
                      &amp;&amp; VV &lt;= len}</span><span class='hs-varid'>i</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : GHC.Word.Word8 | VV /= 0
                       &amp;&amp; VV &gt; 0
                       &amp;&amp; VV &gt;= 0}</span><span class='hs-varid'>b0</span></a>
<span class=hs-linenum>298: </span>      <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v /= 0
                     &amp;&amp; v &gt; 0
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt;= len}</span><span class='hs-varid'>i</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == len}</span><span class='hs-varid'>len</span></a> <span class='hs-comment'>-</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>2</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | not v
                      &amp;&amp; v == False}</span><span class='hs-conid'>False</span></a> <span class='hs-comment'>-- Be careful: i+2 might overflow!</span>
<span class=hs-linenum>299: </span>      <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-varid'>indexIsCont</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v /= 0
                     &amp;&amp; v &gt; 0
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt;= len}</span><span class='hs-varid'>i</span></a>
<span class=hs-linenum>300: </span>      <span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-varid'>indexIsCont</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v /= 0
                     &amp;&amp; v &gt; 0
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt;= len}</span><span class='hs-varid'>i</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>301: </span>      <span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-varid'>indexIsCont</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v /= 0
                     &amp;&amp; v &gt; 0
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt;= len}</span><span class='hs-varid'>i</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>302: </span>      <span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>b1</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>indexWord8</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v /= 0
                     &amp;&amp; v &gt; 0
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt;= len}</span><span class='hs-varid'>i</span></a>
<span class=hs-linenum>303: </span>      <span class='hs-layout'>,</span>    <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == b0
                      &amp;&amp; v /= 0
                      &amp;&amp; v &gt; 0
                      &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>b0</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-num'>0xF0</span></a> <span class='hs-varop'>&amp;&amp;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == b1}</span><span class='hs-varid'>b1</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-num'>0x90</span></a><span class='hs-layout'>)</span> <span class='hs-comment'>-- F0, 90..BF, 80..BF, 80..BF</span>
<span class=hs-linenum>304: </span>        <span class='hs-varop'>||</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == b0
                      &amp;&amp; v /= 0
                      &amp;&amp; v &gt; 0
                      &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>b0</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-num'>0xF1</span></a> <span class='hs-varop'>&amp;&amp;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == b0
                      &amp;&amp; v /= 0
                      &amp;&amp; v &gt; 0
                      &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>b0</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-num'>0xF3</span></a><span class='hs-layout'>)</span> <span class='hs-comment'>-- F1..F3, 80..BF, 80..BF, 80..BF</span>
<span class=hs-linenum>305: </span>        <span class='hs-varop'>||</span> <a class=annot href="#"><span class=annottext>GHC.Types.Bool</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == b0
                      &amp;&amp; v /= 0
                      &amp;&amp; v &gt; 0
                      &amp;&amp; v &gt;= 0}</span><span class='hs-varid'>b0</span></a> <span class='hs-varop'>==</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-num'>0xF4</span></a> <span class='hs-varop'>&amp;&amp;</span> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == b1}</span><span class='hs-varid'>b1</span></a> <span class='hs-varop'>&lt;=</span> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-num'>0x8F</span></a><span class='hs-layout'>)</span> <span class='hs-comment'>-- F4, 80..8F, 80..BF, 80..BF</span>
<span class=hs-linenum>306: </span>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt;= 0} -&gt; (GHC.Types.IO GHC.Types.Bool)</span><span class='hs-varid'>go</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i
                     &amp;&amp; v /= 0
                     &amp;&amp; v &gt; 0
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt;= len}</span><span class='hs-varid'>i</span></a><span class='hs-varop'>+</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>3</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>307: </span>
<span class=hs-linenum>308: </span>      <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>
<span class=hs-linenum>309: </span>      <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Bool | not v
                      &amp;&amp; v == False}</span><span class='hs-conid'>False</span></a>
<span class=hs-linenum>310: </span>
<span class=hs-linenum>311: </span>
<span class=hs-linenum>312: </span><span class='hs-comment'>----------------------------------------------------------------</span>
<span class=hs-linenum>313: </span><span class='hs-comment'>-- Haskell versions of functions in itoa.c</span>
<span class=hs-linenum>314: </span><span class='hs-comment'>----------------------------------------------------------------</span>
<span class=hs-linenum>315: </span>
<span class=hs-linenum>316: </span>
<span class=hs-linenum>317: </span><span class='hs-definition'>getDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Word8</span>
<span class=hs-linenum>318: </span><a class=annot href="#"><span class=annottext>GHC.Types.Int -&gt; GHC.Word.Word8</span><span class='hs-definition'>getDigit</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>I</span><span class='hs-cpp'>#</span> <span class='hs-varid'>i</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>GHC.Prim.Word8#</span><span class='hs-conid'>W8</span></a><span class='hs-cpp'>#</span> <a class=annot href="#"><span class=annottext>GHC.Prim.Word8#</span><span class='hs-layout'>(</span></a><span class='hs-varid'>indexWord8OffAddr</span><span class='hs-cpp'>#</span> <a class=annot href="#"><span class=annottext>{v : GHC.Prim.Addr# | v == "0123456789abcdef"}</span><span class='hs-varid'>digits</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Prim.Int# | v == i}</span><span class='hs-varid'>i</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>319: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>320: </span>    <span class='hs-varop'>!</span><span class='hs-varid'>digits</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Prim.Addr# | v == "0123456789abcdef"}</span><span class='hs-str'>"0123456789abcdef"</span></a><span class='hs-cpp'>#</span>
<span class=hs-linenum>321: </span>
<span class=hs-linenum>322: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>putDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>p</span><span class='hs-conop'>:</span><span class='hs-layout'>(</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{n:</span><span class='hs-conid'>Nat</span> <span class='hs-keyword'>| PtrValidN p n}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>323: </span><span class='hs-definition'>putDigit</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>324: </span><a class=annot href="#"><span class=annottext>forall a .
x1:(GHC.Ptr.Ptr a) -&gt; {VV : GHC.Types.Int | VV &gt;= 0
                                            &amp;&amp; VV &lt; (pbase x1 + plen (pbase x1)) - x1
                                            &amp;&amp; pbase x1 &lt;= x1} -&gt; GHC.Types.Int -&gt; (GHC.Types.IO ())</span><span class='hs-definition'>putDigit</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr a)</span><span class='hs-varid'>addr</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV &gt;= 0
                      &amp;&amp; VV &lt; (pbase addr + plen (pbase addr)) - addr
                      &amp;&amp; pbase addr &lt;= addr}</span><span class='hs-varid'>off</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>i</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (Foreign.Storable.Storable GHC.Word.Word8) | v == $fStorableWord8}</span><span class='hs-conid'>Data.LiquidPtr.pokeByteOff</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr a) | v == addr}</span><span class='hs-varid'>addr</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == off
                     &amp;&amp; v &gt;= 0
                     &amp;&amp; v &lt; (pbase addr + plen (pbase addr)) - addr
                     &amp;&amp; pbase addr &lt;= addr}</span><span class='hs-varid'>off</span></a> <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-layout'>(</span></a><span class='hs-varid'>getDigit</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == i}</span><span class='hs-varid'>i</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>325: </span>
<span class=hs-linenum>326: </span><span class='hs-comment'>-- | Reverse bytes in the given memory range (inclusive)</span>
<span class=hs-linenum>327: </span><span class='hs-definition'>reverseBytesInplace</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>328: </span><a class=annot href="#"><span class=annottext>x1:{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                        &amp;&amp; pbase VV &lt;= VV} -&gt; {VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                                                                                   &amp;&amp; pbase VV &lt;= VV
                                                                                                   &amp;&amp; pbase x1 &lt;= x1} -&gt; (GHC.Types.IO ())</span><span class='hs-definition'>reverseBytesInplace</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                     &amp;&amp; pbase VV &lt;= VV}</span><span class='hs-varid'>p1</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{VV : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase VV + plen (pbase VV)) - VV
                                     &amp;&amp; pbase VV &lt;= VV
                                     &amp;&amp; pbase p1 &lt;= p1}</span><span class='hs-varid'>p2</span></a>
<span class=hs-linenum>329: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p1
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>p1</span></a> <span class='hs-varop'>&lt;</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p2
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase p1 &lt;= p1
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>p2</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>330: </span>    <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>c1</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO GHC.Word.Word8)</span><span class='hs-conid'>Data.LiquidPtr.peekByteOff</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p1
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>p1</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>331: </span>    <a class=annot href="#"><span class=annottext>GHC.Word.Word8</span><span class='hs-varid'>c2</span></a> <span class='hs-keyglyph'>&lt;-</span> <a class=annot href="#"><span class=annottext>(GHC.Types.IO GHC.Word.Word8)</span><span class='hs-conid'>Data.LiquidPtr.peekByteOff</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p2
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase p1 &lt;= p1
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>p2</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a>
<span class=hs-linenum>332: </span>    <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-conid'>Data.LiquidPtr.pokeByteOff</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p1
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>p1</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == c2}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>c2</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>333: </span>    <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-conid'>Data.LiquidPtr.pokeByteOff</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p2
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase p1 &lt;= p1
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>p2</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Word.Word8 | v == c1}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>c1</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>334: </span>    <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-varid'>reverseBytesInplace</span></a> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>plusPtr</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p1
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>p1</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>plusPtr</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == p2
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase p1 &lt;= p1
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>p2</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>335: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>{v : () | v == ()}</span><span class='hs-conid'>()</span></a>
<span class=hs-linenum>336: </span>
<span class=hs-linenum>337: </span><span class='hs-comment'>-- | Encode signed number as decimal</span>
<span class=hs-linenum>338: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>encodeSignedDec</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Num</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Integral</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{p:</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyword'>| PtrValid p}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-layout'>(</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>339: </span><span class='hs-definition'>encodeSignedDec</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Num</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Integral</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>340: </span><span class='hs-comment'>{-# INLINABLE encodeSignedDec #-}</span> <span class='hs-comment'>-- for specialization</span>
<span class=hs-linenum>341: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Eq&lt;[]&gt; a, GHC.Num.Num&lt;[]&gt; a, GHC.Real.Integral&lt;[]&gt; a) =&gt;
a -&gt; {p : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase p + plen (pbase p)) - p
                                         &amp;&amp; pbase p &lt;= p} -&gt; (GHC.Types.IO (GHC.Ptr.Ptr GHC.Word.Word8))</span><span class='hs-definition'>encodeSignedDec</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{p : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase p + plen (pbase p)) - p
                                    &amp;&amp; pbase p &lt;= p}</span><span class='hs-varid'>buf</span></a>
<span class=hs-linenum>342: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a> <span class='hs-varop'>&gt;=</span> <a class=annot href="#"><span class=annottext>a</span><span class='hs-num'>0</span></a>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Real.Integral a) | v == $dIntegral_a38K}</span><span class='hs-varid'>encodeUnsignedDec</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == buf
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>buf</span></a>
<span class=hs-linenum>343: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>344: </span>    <span class='hs-comment'>-- we cannot negate directly as  0 - (minBound :: Int) = minBound</span>
<span class=hs-linenum>345: </span>    <span class='hs-comment'>-- So we write the sign and the first digit.</span>
<span class=hs-linenum>346: </span>    <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-conid'>Data.LiquidPtr.pokeByteOff</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == buf
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>buf</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Char | v == ((lit "45" Char) : Char)}</span><span class='hs-chr'>'-'</span></a>
<span class=hs-linenum>347: </span>    <span class='hs-keyword'>let</span> <span class='hs-varop'>!</span><span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV : a | VV /= 0
          &amp;&amp; VV /= x
          &amp;&amp; VV &gt; 0
          &amp;&amp; VV &gt; x
          &amp;&amp; VV &gt;= 0
          &amp;&amp; VV &gt;= x}</span><span class='hs-varid'>q</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{VV : a | false}</span><span class='hs-varid'>r</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(a, {VV : a | VV &gt;= 0})</span><span class='hs-varid'>quotRem</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == x}</span><span class='hs-varid'>x</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-layout'>(</span></a><span class='hs-comment'>-</span><a class=annot href="#"><span class=annottext>a</span><span class='hs-num'>10</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>348: </span>    <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-varid'>putDigit</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == buf
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>buf</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><span class='hs-varid'>fromIntegral</span> <a class=annot href="#"><span class=annottext>{VV : a | (r &gt;= 0 =&gt; VV == r)
          &amp;&amp; (r &lt; 0 =&gt; VV == (-r))}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>abs</span> <a class=annot href="#"><span class=annottext>{VV : a | false}</span><span class='hs-varid'>r</span></a><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<span class=hs-linenum>349: </span>    <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == q
          &amp;&amp; VV /= 0
          &amp;&amp; VV /= x
          &amp;&amp; VV &gt; 0
          &amp;&amp; VV &gt; x
          &amp;&amp; VV &gt;= 0
          &amp;&amp; VV &gt;= x}</span><span class='hs-varid'>q</span></a> <span class='hs-keyword'>of</span>
<span class=hs-linenum>350: </span>      <span class='hs-num'>0</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Base.Applicative GHC.Types.IO) | v == $fApplicativeIO}</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>plusPtr</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == buf
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>buf</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>351: </span>      <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Eq&lt;[]&gt; a, GHC.Num.Num&lt;[]&gt; a, GHC.Real.Integral&lt;[]&gt; a) =&gt;
a -&gt; {m : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase m + plen (pbase m)) - m
                                         &amp;&amp; pbase m &lt;= m} -&gt; {n : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase n + plen (pbase n)) - n
                                                                                                 &amp;&amp; pbase n &lt;= n} -&gt; (GHC.Types.IO (GHC.Ptr.Ptr GHC.Word.Word8))</span><span class='hs-varid'>encodeUnsignedDec'</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == q
          &amp;&amp; VV /= 0
          &amp;&amp; VV /= x
          &amp;&amp; VV &gt; 0
          &amp;&amp; VV &gt; x
          &amp;&amp; VV &gt;= 0
          &amp;&amp; VV &gt;= x}</span><span class='hs-varid'>q</span></a> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>plusPtr</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == buf
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>buf</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>plusPtr</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == buf
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>buf</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>2</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>352: </span>
<span class=hs-linenum>353: </span>
<span class=hs-linenum>354: </span><span class='hs-comment'>-- | Encode positive number as decimal</span>
<span class=hs-linenum>355: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>encodeUnsignedDec</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Num</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Integral</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{m:</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyword'>| PtrValid m}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-layout'>(</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>356: </span><span class='hs-definition'>encodeUnsignedDec</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Num</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Integral</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>357: </span><span class='hs-comment'>{-# INLINABLE encodeUnsignedDec #-}</span> <span class='hs-comment'>-- for specialization</span>
<span class=hs-linenum>358: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Eq&lt;[]&gt; a, GHC.Num.Num&lt;[]&gt; a, GHC.Real.Integral&lt;[]&gt; a) =&gt;
a -&gt; {m : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase m + plen (pbase m)) - m
                                         &amp;&amp; pbase m &lt;= m} -&gt; (GHC.Types.IO (GHC.Ptr.Ptr GHC.Word.Word8))</span><span class='hs-definition'>encodeUnsignedDec</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>v</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{m : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase m + plen (pbase m)) - m
                                    &amp;&amp; pbase m &lt;= m}</span><span class='hs-varid'>next_ptr</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Eq&lt;[]&gt; a, GHC.Num.Num&lt;[]&gt; a, GHC.Real.Integral&lt;[]&gt; a) =&gt;
a -&gt; {m : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase m + plen (pbase m)) - m
                                         &amp;&amp; pbase m &lt;= m} -&gt; {n : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase n + plen (pbase n)) - n
                                                                                                 &amp;&amp; pbase n &lt;= n} -&gt; (GHC.Types.IO (GHC.Ptr.Ptr GHC.Word.Word8))</span><span class='hs-varid'>encodeUnsignedDec'</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == next_ptr
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>next_ptr</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == next_ptr
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>next_ptr</span></a>
<span class=hs-linenum>359: </span>
<span class=hs-linenum>360: </span><span class='hs-comment'>-- | Encode positive number as little-endian decimal, then reverse it.</span>
<span class=hs-linenum>361: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>362: </span><span class='hs-comment'>-- Take two pointers (orig_ptr, next_ptr) to support already encoded digits</span>
<span class=hs-linenum>363: </span><span class='hs-comment'>-- (e.g. used by encodeSignedDec to avoid overflows)</span>
<span class=hs-linenum>364: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>365: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>encodeUnsignedDec'</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Num</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Integral</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{m:</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyword'>| PtrValid m}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{n:</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyword'>| PtrValid n}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-layout'>(</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>366: </span><span class='hs-definition'>encodeUnsignedDec'</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Num</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Integral</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>367: </span><span class='hs-comment'>{-# INLINABLE encodeUnsignedDec' #-}</span> <span class='hs-comment'>-- for specialization</span>
<span class=hs-linenum>368: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Eq&lt;[]&gt; a, GHC.Num.Num&lt;[]&gt; a, GHC.Real.Integral&lt;[]&gt; a) =&gt;
a -&gt; {m : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase m + plen (pbase m)) - m
                                         &amp;&amp; pbase m &lt;= m} -&gt; {n : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase n + plen (pbase n)) - n
                                                                                                 &amp;&amp; pbase n &lt;= n} -&gt; (GHC.Types.IO (GHC.Ptr.Ptr GHC.Word.Word8))</span><span class='hs-definition'>encodeUnsignedDec'</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>v</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{m : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase m + plen (pbase m)) - m
                                    &amp;&amp; pbase m &lt;= m}</span><span class='hs-varid'>orig_ptr</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{n : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase n + plen (pbase n)) - n
                                    &amp;&amp; pbase n &lt;= n}</span><span class='hs-varid'>next_ptr</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>369: </span>  <span class='hs-keyword'>let</span> <span class='hs-varop'>!</span><span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV : a | VV &gt;= 0}</span><span class='hs-varid'>q</span></a><span class='hs-layout'>,</span><a class=annot href="#"><span class=annottext>{VV : a | VV &gt;= 0}</span><span class='hs-varid'>r</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>({VV : a | 0 &lt;= VV}, {VV : a | 0 &lt;= VV})</span><span class='hs-varid'>divMod</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-num'>10</span></a>
<span class=hs-linenum>370: </span>  <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-varid'>putDigit</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == next_ptr
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>next_ptr</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == r}</span><span class='hs-layout'>(</span></a><span class='hs-varid'>fromIntegral</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == r
          &amp;&amp; VV &gt;= 0}</span><span class='hs-varid'>r</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>371: </span>  <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == q
          &amp;&amp; VV &gt;= 0}</span><span class='hs-varid'>q</span></a> <span class='hs-keyword'>of</span>
<span class=hs-linenum>372: </span>    <span class='hs-num'>0</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>373: </span>      <span class='hs-comment'>-- reverse written digits</span>
<span class=hs-linenum>374: </span>      <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-varid'>reverseBytesInplace</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == orig_ptr
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>orig_ptr</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == next_ptr
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>next_ptr</span></a>
<span class=hs-linenum>375: </span>      <span class='hs-comment'>-- return pointer after our digits</span>
<span class=hs-linenum>376: </span>      <a class=annot href="#"><span class=annottext>(GHC.Types.IO (GHC.Ptr.Ptr GHC.Word.Word8))</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>plusPtr</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == next_ptr
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>next_ptr</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>377: </span>    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Eq&lt;[]&gt; a, GHC.Num.Num&lt;[]&gt; a, GHC.Real.Integral&lt;[]&gt; a) =&gt;
a -&gt; {m : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase m + plen (pbase m)) - m
                                         &amp;&amp; pbase m &lt;= m} -&gt; {n : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase n + plen (pbase n)) - n
                                                                                                 &amp;&amp; pbase n &lt;= n} -&gt; (GHC.Types.IO (GHC.Ptr.Ptr GHC.Word.Word8))</span><span class='hs-varid'>encodeUnsignedDec'</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == q
          &amp;&amp; VV &gt;= 0}</span><span class='hs-varid'>q</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == orig_ptr
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>orig_ptr</span></a> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>plusPtr</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == next_ptr
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>next_ptr</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>378: </span>
<span class=hs-linenum>379: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>assume</span> <span class='hs-varid'>divMod</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-keyword'>{v:</span><span class='hs-keyword'>_</span> <span class='hs-keyword'>| 0 &lt;= v}</span><span class='hs-layout'>,</span> <span class='hs-keyword'>{v:</span><span class='hs-keyword'>_</span> <span class='hs-keyword'>| 0 &lt;= v}</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>380: </span>
<span class=hs-linenum>381: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>ignore</span> <span class='hs-varid'>encodeUnsignedDecPadded</span> <span class='hs-keyword'>@-}</span> <span class='hs-comment'>-- ?</span>
<span class=hs-linenum>382: </span><span class='hs-definition'>encodeUnsignedDecPadded</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Num</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Integral</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>383: </span><span class='hs-comment'>{-# INLINABLE encodeUnsignedDecPadded #-}</span> <span class='hs-comment'>-- for specialization</span>
<span class=hs-linenum>384: </span><span class='hs-definition'>encodeUnsignedDecPadded</span> <span class='hs-varop'>!</span><span class='hs-varid'>max_width</span> <span class='hs-varop'>!</span><span class='hs-varid'>v</span> <span class='hs-varop'>!</span><span class='hs-varid'>buf</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>assert</span> <span class='hs-layout'>(</span><span class='hs-varid'>max_width</span> <span class='hs-varop'>&gt;</span> <span class='hs-num'>0</span><span class='hs-layout'>)</span> <span class='hs-varop'>$</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>385: </span>  <span class='hs-keyword'>let</span> <span class='hs-varop'>!</span><span class='hs-layout'>(</span><span class='hs-varid'>q</span><span class='hs-layout'>,</span><span class='hs-varid'>r</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>divMod</span> <span class='hs-varid'>v</span> <span class='hs-num'>10</span>
<span class=hs-linenum>386: </span>  <span class='hs-varid'>putDigit</span> <span class='hs-varid'>buf</span> <span class='hs-layout'>(</span><span class='hs-varid'>max_width</span> <span class='hs-comment'>-</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>fromIntegral</span> <span class='hs-varid'>r</span><span class='hs-layout'>)</span>
<span class=hs-linenum>387: </span>  <span class='hs-keyword'>case</span> <span class='hs-varid'>q</span> <span class='hs-keyword'>of</span>
<span class=hs-linenum>388: </span>    <span class='hs-num'>0</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>389: </span>        <span class='hs-comment'>-- pad beginning</span>
<span class=hs-linenum>390: </span>        <span class='hs-keyword'>let</span> <span class='hs-varid'>pad</span> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>pure</span> <span class='hs-conid'>()</span>
<span class=hs-linenum>391: </span>            <span class='hs-varid'>pad</span> <span class='hs-varid'>n</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>putDigit</span> <span class='hs-varid'>buf</span> <span class='hs-layout'>(</span><span class='hs-varid'>n</span> <span class='hs-comment'>-</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-num'>0</span> <span class='hs-varop'>&gt;&gt;</span> <span class='hs-varid'>pad</span> <span class='hs-layout'>(</span><span class='hs-varid'>n</span> <span class='hs-comment'>-</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>392: </span>        <span class='hs-varid'>pad</span> <span class='hs-layout'>(</span><span class='hs-varid'>max_width</span> <span class='hs-comment'>-</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span>
<span class=hs-linenum>393: </span>    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>encodeUnsignedDecPadded</span> <span class='hs-layout'>(</span><span class='hs-varid'>max_width</span> <span class='hs-comment'>-</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>q</span> <span class='hs-varid'>buf</span>
<span class=hs-linenum>394: </span>
<span class=hs-linenum>395: </span>
<span class=hs-linenum>396: </span>
<span class=hs-linenum>397: </span><span class='hs-comment'>-- | Encode positive number as hexadecimal</span>
<span class=hs-linenum>398: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>encodeUnsignedHex</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Num</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Integral</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Bits</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{m:</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyword'>| PtrValid m}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-layout'>(</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>399: </span><span class='hs-definition'>encodeUnsignedHex</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Num</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Integral</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Bits</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>400: </span><span class='hs-comment'>{-# INLINABLE encodeUnsignedHex #-}</span> <span class='hs-comment'>-- for specialization</span>
<span class=hs-linenum>401: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Eq&lt;[]&gt; a, GHC.Num.Num&lt;[]&gt; a, GHC.Real.Integral&lt;[]&gt; a, GHC.Bits.Bits&lt;[]&gt; a) =&gt;
a -&gt; {m : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase m + plen (pbase m)) - m
                                         &amp;&amp; pbase m &lt;= m} -&gt; (GHC.Types.IO (GHC.Ptr.Ptr GHC.Word.Word8))</span><span class='hs-definition'>encodeUnsignedHex</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>v</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{m : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase m + plen (pbase m)) - m
                                    &amp;&amp; pbase m &lt;= m}</span><span class='hs-varid'>next_ptr</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Eq&lt;[]&gt; a, GHC.Num.Num&lt;[]&gt; a, GHC.Real.Integral&lt;[]&gt; a, GHC.Bits.Bits&lt;[]&gt; a) =&gt;
a -&gt; {m : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase m + plen (pbase m)) - m
                                         &amp;&amp; pbase m &lt;= m} -&gt; {n : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase n + plen (pbase n)) - n
                                                                                                 &amp;&amp; pbase n &lt;= n} -&gt; (GHC.Types.IO (GHC.Ptr.Ptr GHC.Word.Word8))</span><span class='hs-varid'>encodeUnsignedHex'</span></a> <a class=annot href="#"><span class=annottext>{VV : a | VV == v}</span><span class='hs-varid'>v</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == next_ptr
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>next_ptr</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == next_ptr
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>next_ptr</span></a>
<span class=hs-linenum>402: </span>
<span class=hs-linenum>403: </span><span class='hs-comment'>-- | Encode positive number as little-endian hexdecimal, then reverse it.</span>
<span class=hs-linenum>404: </span><span class='hs-comment'>--</span>
<span class=hs-linenum>405: </span><span class='hs-comment'>-- Take two pointers (orig_ptr, next_ptr) to support already encoded digits</span>
<span class=hs-linenum>406: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>encodeUnsignedHex'</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Num</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Integral</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Bits</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{m:</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyword'>| PtrValid m}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{n:</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyword'>| PtrValid n}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-layout'>(</span><span class='hs-conid'>GHC.Ptr.Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>407: </span><span class='hs-definition'>encodeUnsignedHex'</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Eq</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Num</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Integral</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Bits</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>IO</span> <span class='hs-layout'>(</span><span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word8</span><span class='hs-layout'>)</span>
<span class=hs-linenum>408: </span><span class='hs-comment'>{-# INLINABLE encodeUnsignedHex' #-}</span> <span class='hs-comment'>-- for specialization</span>
<span class=hs-linenum>409: </span><a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Eq&lt;[]&gt; a, GHC.Num.Num&lt;[]&gt; a, GHC.Real.Integral&lt;[]&gt; a, GHC.Bits.Bits&lt;[]&gt; a) =&gt;
a -&gt; {m : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase m + plen (pbase m)) - m
                                         &amp;&amp; pbase m &lt;= m} -&gt; {n : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase n + plen (pbase n)) - n
                                                                                                 &amp;&amp; pbase n &lt;= n} -&gt; (GHC.Types.IO (GHC.Ptr.Ptr GHC.Word.Word8))</span><span class='hs-definition'>encodeUnsignedHex'</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>v</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{m : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase m + plen (pbase m)) - m
                                    &amp;&amp; pbase m &lt;= m}</span><span class='hs-varid'>orig_ptr</span></a> <span class='hs-varop'>!</span><a class=annot href="#"><span class=annottext>{n : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase n + plen (pbase n)) - n
                                    &amp;&amp; pbase n &lt;= n}</span><span class='hs-varid'>next_ptr</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>410: </span>  <span class='hs-comment'>-- (q,r) = divMod v 16, but faster</span>
<span class=hs-linenum>411: </span>  <span class='hs-keyword'>let</span> <span class='hs-varop'>!</span><span class='hs-varid'>q</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == v}</span><span class='hs-varid'>v</span></a> <span class='hs-varop'>`shiftR`</span> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>4</span></a>
<span class=hs-linenum>412: </span>  <span class='hs-keyword'>let</span> <span class='hs-varop'>!</span><span class='hs-varid'>r</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{VV : a | VV == v}</span><span class='hs-varid'>v</span></a> <span class='hs-varop'>.&amp;.</span> <a class=annot href="#"><span class=annottext>a</span><span class='hs-num'>0x0F</span></a>
<span class=hs-linenum>413: </span>  <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-varid'>putDigit</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == next_ptr
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>next_ptr</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>0</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-layout'>(</span></a><span class='hs-varid'>fromIntegral</span> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>r</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>414: </span>  <span class='hs-keyword'>case</span> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>q</span></a> <span class='hs-keyword'>of</span>
<span class=hs-linenum>415: </span>    <span class='hs-num'>0</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>do</span>
<span class=hs-linenum>416: </span>      <span class='hs-comment'>-- reverse written digits</span>
<span class=hs-linenum>417: </span>      <a class=annot href="#"><span class=annottext>(GHC.Types.IO ())</span><span class='hs-varid'>reverseBytesInplace</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == orig_ptr
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>orig_ptr</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == next_ptr
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>next_ptr</span></a>
<span class=hs-linenum>418: </span>      <span class='hs-comment'>-- return pointer after our digits</span>
<span class=hs-linenum>419: </span>      <a class=annot href="#"><span class=annottext>(GHC.Types.IO (GHC.Ptr.Ptr GHC.Word.Word8))</span><span class='hs-varid'>pure</span></a> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>plusPtr</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == next_ptr
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>next_ptr</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>420: </span>    <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>-&gt;</span> <a class=annot href="#"><span class=annottext>forall a .
(GHC.Classes.Eq&lt;[]&gt; a, GHC.Num.Num&lt;[]&gt; a, GHC.Real.Integral&lt;[]&gt; a, GHC.Bits.Bits&lt;[]&gt; a) =&gt;
a -&gt; {m : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase m + plen (pbase m)) - m
                                         &amp;&amp; pbase m &lt;= m} -&gt; {n : (GHC.Ptr.Ptr GHC.Word.Word8) | 0 &lt; (pbase n + plen (pbase n)) - n
                                                                                                 &amp;&amp; pbase n &lt;= n} -&gt; (GHC.Types.IO (GHC.Ptr.Ptr GHC.Word.Word8))</span><span class='hs-varid'>encodeUnsignedHex'</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>q</span></a> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == orig_ptr
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>orig_ptr</span></a> <a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word8)</span><span class='hs-layout'>(</span></a><span class='hs-varid'>plusPtr</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Ptr.Ptr GHC.Word.Word8) | v == next_ptr
                                    &amp;&amp; 0 &lt; (pbase v + plen (pbase v)) - v
                                    &amp;&amp; pbase v &lt;= v}</span><span class='hs-varid'>next_ptr</span></a> <a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-num'>1</span></a><span class='hs-layout'>)</span>
<span class=hs-linenum>421: </span>
<span class=hs-linenum>422: </span>
<span class=hs-linenum>423: </span><span class='hs-definition'>lower_hex_table</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word16</span>
<span class=hs-linenum>424: </span><a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word16)</span><span class='hs-definition'>lower_hex_table</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Ptr</span>
<span class=hs-linenum>425: </span>  <span class='hs-str'>"000102030405060708090a0b0c0d0e0f\
  \101112131415161718191a1b1c1d1e1f\
  \202122232425262728292a2b2c2d2e2f\
  \303132333435363738393a3b3c3d3e3f\
  \404142434445464748494a4b4c4d4e4f\
  \505152535455565758595a5b5c5d5e5f\
  \606162636465666768696a6b6c6d6e6f\
  \707172737475767778797a7b7c7d7e7f\
  \808182838485868788898a8b8c8d8e8f\
  \909192939495969798999a9b9c9d9e9f\
  \a0a1a2a3a4a5a6a7a8a9aaabacadaeaf\
  \b0b1b2b3b4b5b6b7b8b9babbbcbdbebf\
  \c0c1c2c3c4c5c6c7c8c9cacbcccdcecf\
  \d0d1d2d3d4d5d6d7d8d9dadbdcdddedf\
  \e0e1e2e3e4e5e6e7e8e9eaebecedeeef\
  \f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff"</span><span class='hs-cpp'>#</span>
<span class=hs-linenum>441: </span>
<span class=hs-linenum>442: </span><span class='hs-definition'>digit_pairs_table</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Ptr</span> <span class='hs-conid'>Word16</span>
<span class=hs-linenum>443: </span><a class=annot href="#"><span class=annottext>(GHC.Ptr.Ptr GHC.Word.Word16)</span><span class='hs-definition'>digit_pairs_table</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Ptr</span>
<span class=hs-linenum>444: </span>  <span class='hs-str'>"00010203040506070809\
  \10111213141516171819\
  \20212223242526272829\
  \30313233343536373839\
  \40414243444546474849\
  \50515253545556575859\
  \60616263646566676869\
  \70717273747576777879\
  \80818283848586878889\
  \90919293949596979899"</span><span class='hs-cpp'>#</span>
</pre>
</body>
</html>